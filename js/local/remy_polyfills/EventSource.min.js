(function(b){if("EventSource" in b){return}var c=/^(\s|\u00A0)+|(\s|\u00A0)+$/g;var d=function(h){var j=this,g=500,e=null,f="";if(!h||typeof h!="string"){throw new SyntaxError("Not enough arguments")}this.URL=h;this.readyState=this.CONNECTING;this._pollTimer=null;this._xhr=null;function i(l){j._pollTimer=setTimeout(function(){k.call(j)},l)}function k(){try{if(j.readyState==j.CLOSED){return}var m=new XMLHttpRequest();m.open("GET",j.URL,true);m.setRequestHeader("Accept","text/event-stream");m.setRequestHeader("Cache-Control","no-cache");m.setRequestHeader("X-Requested-With","XMLHttpRequest");if(e!=null){m.setRequestHeader("Last-Event-ID",e)}f="";m.timeout=50000;m.onreadystatechange=function(){if(this.readyState==3||(this.readyState==4&&this.status==200)){if(j.readyState==j.CONNECTING){j.readyState=j.OPEN;j.dispatchEvent("open",{type:"open"})}var u="";try{u=this.responseText||""}catch(t){}var q=u.substr(f.length).split("\n"),p="message",r=[],s=0,v="";f=u;for(;s<q.length;s++){v=q[s].replace(c,"");if(v.indexOf("event")==0){p=v.replace(/event:?\s*/,"")}else{if(v.indexOf("retry")==0){var n=parseInt(v.replace(/retry:?\s*/,""));if(!isNaN(n)){g=n}}else{if(v.indexOf("data")==0){r.push(v.replace(/data:?\s*/,""))}else{if(v.indexOf("id:")==0){e=v.replace(/id:?\s*/,"")}else{if(v.indexOf("id")==0){e=null}else{if(v==""){if(r.length){var o=new a(r.join("\n"),j.url,e);j.dispatchEvent(p,o);r=[];p="message"}}}}}}}}if(this.readyState==4){i(g)}}else{if(j.readyState!==j.CLOSED){if(this.readyState==4){j.readyState=j.CONNECTING;j.dispatchEvent("error",{type:"error"});i(g)}else{if(this.readyState==0){i(g)}else{}}}}};m.send();setTimeout(function(){if(true||m.readyState==3){m.abort()}},m.timeout);j._xhr=m}catch(l){j.dispatchEvent("error",{type:"error",data:l.message})}}k()};d.prototype={close:function(){this.readyState=this.CLOSED;clearInterval(this._pollTimer);this._xhr.abort()},CONNECTING:0,OPEN:1,CLOSED:2,dispatchEvent:function(g,h){var e=this["_"+g+"Handlers"];if(e){for(var f=0;f<e.length;f++){e[f].call(this,h)}}if(this["on"+g]){this["on"+g].call(this,h)}},addEventListener:function(f,e){if(!this["_"+f+"Handlers"]){this["_"+f+"Handlers"]=[]}this["_"+f+"Handlers"].push(e)},removeEventListener:function(h,g){var e=this["_"+h+"Handlers"];if(!e){return}for(var f=e.length-1;f>=0;--f){if(e[f]===g){e.splice(f,1);break}}},onerror:null,onmessage:null,onopen:null,readyState:0,URL:""};var a=function(g,f,e){this.data=g;this.origin=f;this.lastEventId=e||""};a.prototype={data:null,type:"message",lastEventId:"",origin:""};if("module" in b){module.exports=d}b.EventSource=d})(this);