var _slice=Array.prototype.slice;var getPromise=require("./_promise.js");var deferred=function(c){var g=getPromise();var f,e,h=new g(function(j,i){f=j;e=i});var d=(c&&c.pattern);var b=(c&&c.noError);var a=d?function(l){if(l&&!b){return e(l)}var j={},k,m=b?0:1;for(k=0;k<d.length;k++){j[d[k]]=arguments[k+m]}f(j)}:b?f:function(i,j){if(i){e(i)}else{f(j)}};return{promise:h,callback:a}};var promisify=module.exports=function(c,d,a,b){if(b&&b.callbackIsFirstArg){return function(e){if(typeof(e)==="function"){return d.apply(c,arguments)}var g=deferred(b);var f=_slice.call(arguments,0);f.unshift(g.callback);d.apply(c,f);return g.promise}}return function(){var e=arguments[arguments.length-1];if(typeof(e)==="function"){return d.apply(c,arguments)}var h=deferred(b);var g=_slice.call(arguments,0);while(g.length<a){g.push(undefined)}g.push(h.callback);var f=d.apply(c,g);if(b&&b.returnsObject){Object.defineProperty(f,"promise",{value:h.promise});return f}return h.promise}};